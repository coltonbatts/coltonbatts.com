---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
	const tools = await getCollection('tools');
	return tools.map((tool) => ({
		params: { slug: tool.slug },
		props: { tool },
	}));
}

const { tool } = Astro.props;
const { Content } = await tool.render();
---

<BaseLayout title={tool.data.name} description={tool.data.oneLiner}>
	<article class="max-w-4xl mx-auto px-6 py-12">
		<header class="mb-8">
			<div class="mb-4">
				<a href="/tools" class="text-sm text-gray-600 hover:underline">
					← Back to Tools
				</a>
			</div>
			<h1 class="text-4xl font-bold mb-3">{tool.data.name}</h1>
			<p class="text-xl text-gray-700 mb-4">{tool.data.oneLiner}</p>
			<div class="flex items-center gap-3 mb-6">
				<span
					class="px-3 py-1 border border-black text-sm"
					class:list={{
						'bg-black text-white': tool.data.status === 'active',
						'bg-gray-100': tool.data.status === 'beta',
						'bg-gray-200': tool.data.status === 'archived',
					}}
				>
					{tool.data.status}
				</span>
				<span class="text-sm text-gray-600">{tool.data.platform}</span>
			</div>
		</header>

		{tool.data.links.length > 0 && (
			<div class="mb-8 pb-8 border-b border-black">
				<h2 class="text-lg font-semibold mb-3">Links</h2>
				<ul class="space-y-2">
					{tool.data.links.map((link) => (
						<li>
							<a
								href={link.url}
								target="_blank"
								rel="noopener noreferrer"
								class="text-blue-700 hover:underline"
							>
								{link.label} →
							</a>
						</li>
					))}
				</ul>
			</div>
		)}

		{tool.data.bullets.length > 0 && (
			<section class="mb-8">
				<h2 class="text-lg font-semibold mb-3">Features</h2>
				<ul class="list-disc list-inside space-y-2 text-gray-700">
					{tool.data.bullets.map((bullet) => (
						<li>{bullet}</li>
					))}
				</ul>
			</section>
		)}

		<section class="prose prose-lg max-w-none">
			<h2 class="text-lg font-semibold mb-3">Philosophy</h2>
			<Content />
		</section>
	</article>
</BaseLayout>
