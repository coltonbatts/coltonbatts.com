@tailwind base;
@tailwind components;
@tailwind utilities;

/* =============================================================
 * SELF-HOSTED FONTS
 * No external CDNs. These files live in /public/fonts/.
 * IBM Plex Mono: the instrument layer (nav, labels, metadata).
 * Inter: the structural layer (headlines, body, authority).
 * ============================================================= */

@font-face {
	font-family: 'IBM Plex Mono';
	src: url('/fonts/IBMPlexMono-Regular.woff2') format('woff2');
	font-weight: 400;
	font-style: normal;
	font-display: swap;
}

@font-face {
	font-family: 'IBM Plex Mono';
	src: url('/fonts/IBMPlexMono-Medium.woff2') format('woff2');
	font-weight: 500;
	font-style: normal;
	font-display: swap;
}

@font-face {
	font-family: 'IBM Plex Mono';
	src: url('/fonts/IBMPlexMono-Bold.woff2') format('woff2');
	font-weight: 700;
	font-style: normal;
	font-display: swap;
}

@font-face {
	font-family: 'Inter';
	src: url('/fonts/Inter-Regular.woff2') format('woff2');
	font-weight: 400;
	font-style: normal;
	font-display: swap;
}

@font-face {
	font-family: 'Inter';
	src: url('/fonts/Inter-Medium.woff2') format('woff2');
	font-weight: 500;
	font-style: normal;
	font-display: swap;
}

@font-face {
	font-family: 'Inter';
	src: url('/fonts/Inter-Bold.woff2') format('woff2');
	font-weight: 700;
	font-style: normal;
	font-display: swap;
}

@font-face {
	font-family: 'Inter';
	src: url('/fonts/Inter-Black.woff2') format('woff2');
	font-weight: 900;
	font-style: normal;
	font-display: swap;
}

@font-face {
	font-family: 'UnifrakturMaguntia';
	src: url('/fonts/UnifrakturMaguntia-Regular.woff2') format('woff2');
	font-weight: 400;
	font-style: normal;
	font-display: swap;
}

/* =============================================================
 * CSS CUSTOM PROPERTIES
 * The design language distilled into tokens.
 * ============================================================= */

:root {
	--charcoal: #1a1a1a;
	--ink: #0d0d0d;
	--bg-manual: #e8e5df;
	--bg-manual-light: #edeae5;
	--bone: #d5d0c8;
	--raw: #9b1b1b;
	--raw-dark: #7a1515;

	/* Borders — the structural grid */
	--border-weight: 2px;
	--border-color: var(--charcoal);
	--border-muted: var(--bone);

	/* Material noise — SVG feTurbulence, no image files */
	--noise-opacity: 0.28;
	--noise-blend: multiply;

	/* Shadows — stamped, not floating */
	--shadow-stamp: 3px 3px 0px rgba(0, 0, 0, 0.15);
	--shadow-stamp-lg: 6px 6px 0px rgba(0, 0, 0, 0.12);
	--shadow-stamp-hover: 6px 6px 0px rgba(0, 0, 0, 0.18);
	--motion-strength: 0.66;
	--motion-hero-progress: 0;
	--motion-specimen-progress: 0;
}

/* =============================================================
 * BASE LAYER
 * ============================================================= */

@layer base {
	html {
		font-family: 'Inter', system-ui, -apple-system, sans-serif;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		letter-spacing: -0.01em;
		background-color: var(--bg-manual);
		font-variant-numeric: tabular-nums;
	}

	body {
		background-color: var(--bg-manual);
		min-height: 100vh;
		color: var(--charcoal);
		position: relative;
		isolation: isolate;
	}

	/* Atmospheric lighting — desk lamp radial vignette */
	body::before {
		content: '';
		position: fixed;
		inset: 0;
		background: radial-gradient(
			ellipse 70% 60% at 50% 40%,
			var(--bg-manual-light) 0%,
			var(--bg-manual) 50%,
			#d6d3cc 100%
		);
		z-index: -2;
		pointer-events: none;
	}

	/* Material noise — unified SVG feTurbulence overlay, no seams */
	body::after {
		content: '';
		position: fixed;
		inset: 0;
		z-index: 9999;
		pointer-events: none;
		opacity: var(--noise-opacity);
		mix-blend-mode: var(--noise-blend);
		background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.7' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
		background-repeat: repeat;
		background-size: 256px 256px;
	}

	/* -----------------------------------------------------------
	 * GLOBAL TYPOGRAPHY RESETS
	 * Headlines are black, heavy, and tight. Body is readable.
	 * Monospace is used for anything that labels or classifies.
	 * ----------------------------------------------------------- */

	h1, h2, h3, h4, h5, h6 {
		font-family: 'Inter', system-ui, sans-serif;
		font-weight: 900;
		letter-spacing: -0.03em;
		line-height: 1.1;
		color: var(--ink);
	}

	h1 { font-size: 2.75rem; letter-spacing: -0.04em; }
	h2 { font-size: 2rem; letter-spacing: -0.03em; }
	h3 { font-size: 1.5rem; }
	h4 { font-size: 1.125rem; }

	@media (min-width: 768px) {
		h1 { font-size: 3.5rem; }
		h2 { font-size: 2.5rem; }
		h3 { font-size: 1.75rem; }
	}

	/* Kill all border-radius globally as reinforcement */
	*, *::before, *::after {
		border-radius: 0 !important;
	}

	/* -----------------------------------------------------------
	 * MOBILE MENU TOGGLE: Hamburger → X morph
	 * Three spans animate into a cross when .is-open is set.
	 * ----------------------------------------------------------- */

	#mobile-menu-toggle span {
		transition: transform 0.2s cubic-bezier(0.2, 0, 0, 1),
					opacity 0.15s ease;
		transform-origin: center;
	}

	#mobile-menu-toggle.is-open span:nth-child(1) {
		transform: translateY(4px) rotate(45deg);
	}

	#mobile-menu-toggle.is-open span:nth-child(2) {
		opacity: 0;
		transform: scaleX(0);
	}

	#mobile-menu-toggle.is-open span:nth-child(3) {
		transform: translateY(-4px) rotate(-45deg);
	}

	/* Selection highlight uses the raw accent */
	::selection {
		background-color: var(--raw);
		color: white;
	}

	/* Links: raw accent on hover, no ambiguity */
	a {
		transition: color 0.15s ease;
	}

	/* Focus states: stark, visible, accessible */
	:focus-visible {
		outline: 2px solid var(--raw);
		outline-offset: 2px;
	}

	/* Horizontal rules: structural dividers */
	hr {
		border: none;
		border-top: var(--border-weight) solid var(--border-color);
		margin: 2rem 0;
	}

	/* Print styles */
	@media print {
		header, footer { display: none; }
		a { text-decoration: underline; }
		a[href^="http"]:after {
			content: " (" attr(href) ")";
			font-size: 0.8em;
			color: #666;
		}
	}
}

/* =============================================================
 * COMPONENT LAYER
 * Reusable structural patterns.
 * ============================================================= */

@layer components {

	/* -----------------------------------------------------------
	 * SECTION CONTAINER: The structural card
	 * Used for any boxed content section.
	 * ----------------------------------------------------------- */

	.section-block {
		background-color: var(--bg-manual-light);
		border: var(--border-weight) solid var(--border-color);
		box-shadow: var(--shadow-stamp);
		padding: 2rem;
		transition: transform 0.2s cubic-bezier(0.2, 0, 0, 1),
					box-shadow 0.2s cubic-bezier(0.2, 0, 0, 1);
	}

	.section-block:hover {
		transform: translate(-2px, -2px);
		box-shadow: var(--shadow-stamp-hover);
	}

	/* Non-interactive blocks shouldn't shift on hover */
	.section-block--static {
		pointer-events: auto;
	}

	.section-block--static:hover {
		transform: none;
		box-shadow: var(--shadow-stamp);
	}

	/* -----------------------------------------------------------
	 * SECTION LABEL: Monospaced category headers
	 * The "machine-engraved plate" above content sections.
	 * ----------------------------------------------------------- */

	.section-label {
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.6875rem;
		font-weight: 700;
		text-transform: uppercase;
		letter-spacing: 0.12em;
		color: rgba(0, 0, 0, 0.4);
		padding-bottom: 0.5rem;
		border-bottom: 1px solid var(--bone);
		margin-bottom: 1.5rem;
	}

	/* -----------------------------------------------------------
	 * INSTRUMENT BUTTON: The primary CTA
	 * Heavy border, monospaced text, physical feedback.
	 * ----------------------------------------------------------- */

	.btn-instrument {
		display: inline-block;
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.75rem;
		font-weight: 700;
		text-transform: uppercase;
		letter-spacing: 0.1em;
		padding: 0.75rem 1.5rem;
		border: var(--border-weight) solid var(--charcoal);
		background: transparent;
		color: var(--charcoal);
		box-shadow: 3px 3px 0px rgba(0, 0, 0, 0.15);
		transition: all 0.15s cubic-bezier(0.2, 0, 0, 1);
		cursor: pointer;
		text-decoration: none;
	}

	/* Trusted-by logos: normalized footprint with restrained contrast */
	.trusted-by-strip {
		border-top: 1px solid var(--bone);
		padding-top: 1.1rem;
		max-width: 42rem;
	}

	.trusted-logo-wrap {
		display: flex;
		align-items: center;
		justify-content: flex-start;
		min-height: 3.5rem;
	}

	.trusted-logo-image {
		display: block;
		width: auto;
		object-fit: contain;
		opacity: 0.72;
		filter: grayscale(100%) contrast(110%);
		transition: opacity 0.2s ease;
	}

	.trusted-logo-wrap:hover .trusted-logo-image {
		opacity: 0.9;
	}

	/*
	 * Per-logo optical sizing.
	 * Each height is hand-tuned so the primary wordmark / mark
	 * in every logo reads at the same visual weight.
	 *
	 *   nuuly          — bold, ultra-wide wordmark (4:1)
	 *   kate spade     — light wordmark + "NEW YORK" (1.4:1)
	 *   under armour   — UA shield + stacked text (1.2:1)
	 *   google shopping — bag icon + text (1.7:1)
	 */
	.trusted-logo-image--nuuly          { height: 1.5rem; }
	.trusted-logo-image--kate-spade     { height: 3.2rem; }
	.trusted-logo-image--under-armour   { height: 3rem; }
	.trusted-logo-image--google-shopping { height: 2.2rem; }

	.btn-instrument:hover {
		background: var(--charcoal);
		color: var(--bg-manual);
		transform: translate(-1px, -1px);
		box-shadow: 4px 4px 0px rgba(0, 0, 0, 0.2);
	}

	.btn-instrument:active {
		transform: translate(1px, 1px);
		box-shadow: 1px 1px 0px rgba(0, 0, 0, 0.15);
	}

	/* Raw accent variant */
	.btn-instrument--raw {
		border-color: var(--raw);
		color: var(--raw);
	}

	.btn-instrument--raw:hover {
		background: var(--raw);
		color: white;
		box-shadow: 4px 4px 0px rgba(155, 27, 27, 0.25);
	}

	/* -----------------------------------------------------------
	 * STATUS BADGE: Monospaced pill
	 * ----------------------------------------------------------- */

	.status-badge {
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.625rem;
		font-weight: 700;
		text-transform: uppercase;
		letter-spacing: 0.1em;
		padding: 0.25rem 0.75rem;
		border: var(--border-weight) solid var(--charcoal);
		display: inline-block;
	}

	.status-badge--active {
		background: var(--charcoal);
		color: var(--bg-manual);
	}

	.status-badge--beta {
		background: transparent;
		color: var(--charcoal);
	}

	.status-badge--archived {
		border-color: var(--bone);
		color: rgba(0, 0, 0, 0.35);
	}

	/* -----------------------------------------------------------
	 * ART PLATE: Gallery frame system
	 * Upgraded to the new border/shadow language.
	 * ----------------------------------------------------------- */

	.art-plate {
		display: flex;
		flex-direction: column;
		gap: 0.5rem;
	}

	.art-plate__inner {
		padding: 0.5rem;
		background-color: var(--bg-manual-light);
		border: var(--border-weight) solid var(--border-color);
		box-shadow: var(--shadow-stamp);
		transition: transform 0.2s cubic-bezier(0.2, 0, 0, 1),
					box-shadow 0.2s cubic-bezier(0.2, 0, 0, 1);
	}

	.art-plate--surface-paper .art-plate__inner {
		background: #fafaf8;
	}

	.art-plate--surface-ink .art-plate__inner {
		background: #f0f0ee;
	}

	.art-plate--matted .art-plate__inner {
		padding: 2rem;
	}

	.art-plate--float .art-plate__inner {
		padding: 0.75rem;
		box-shadow: var(--shadow-stamp-lg);
		transform: translate(-1px, -1px);
	}

	.art-plate:hover .art-plate__inner {
		transform: translate(-2px, -2px);
		box-shadow: var(--shadow-stamp-hover);
	}

	.art-plate__caption {
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.6875rem;
		line-height: 1.35;
		letter-spacing: 0.02em;
		color: rgba(0, 0, 0, 0.5);
	}

	.art-plate__link {
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.6875rem;
		line-height: 1.35;
		letter-spacing: 0.02em;
		color: var(--raw);
		text-decoration: underline;
		text-underline-offset: 3px;
		text-decoration-thickness: 1px;
	}

	.art-plate__link:hover,
	.art-plate__link:focus-visible {
		color: var(--raw-dark);
		text-decoration-thickness: 2px;
	}

	/* -----------------------------------------------------------
	 * ART SLOT: Media frame
	 * ----------------------------------------------------------- */

	.art-slot__frame {
		position: relative;
		width: 100%;
		overflow: hidden;
		background: rgba(0, 0, 0, 0.03);
	}

	@supports (aspect-ratio: 1 / 1) {
		.art-slot__frame {
			aspect-ratio: var(--slot-aspect, 16 / 9);
		}
	}

	@supports not (aspect-ratio: 1 / 1) {
		.art-slot__frame::before {
			content: '';
			display: block;
			padding-top: var(--slot-ratio, 56.25%);
		}
		.art-slot__frame > * {
			position: absolute;
			inset: 0;
		}
	}

	.art-slot__media {
		width: 100%;
		height: 100%;
		object-fit: var(--slot-fit, cover);
		object-position: var(--slot-position, 50% 50%);
		display: block;
	}

	.art-slot__rive,
	.art-slot__empty {
		display: flex;
		align-items: center;
		justify-content: center;
		width: 100%;
		height: 100%;
		background: rgba(0, 0, 0, 0.03);
	}

	.art-slot__empty {
		position: relative;
	}

	/* Empty state crosshair — structural, not decorative */
	.art-slot__empty::before,
	.art-slot__empty::after {
		content: '';
		position: absolute;
		background: rgba(0, 0, 0, 0.15);
	}

	.art-slot__empty::before {
		width: 28%;
		height: 2px;
		left: 36%;
		top: 50%;
	}

	.art-slot__empty::after {
		width: 2px;
		height: 28%;
		top: 36%;
		left: 50%;
	}

	.art-slot__empty > span {
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.6875rem;
		letter-spacing: 0.08em;
		text-transform: uppercase;
		color: rgba(0, 0, 0, 0.4);
		z-index: 1;
	}

	.art-slot__rive {
		position: relative;
	}

	.rive-player {
		position: relative;
	}

	.art-slot__rive-canvas,
	.art-slot__rive-fallback,
	.art-slot__rive-empty {
		position: absolute;
		inset: 0;
	}

	.art-slot__rive-canvas {
		width: 100% !important;
		height: 100% !important;
		opacity: 0;
	}

	.art-slot__rive-fallback {
		opacity: 1;
	}

	.art-slot__rive--loaded .art-slot__rive-canvas {
		opacity: 1;
	}

	.art-slot__rive--loaded .art-slot__rive-empty,
	.art-slot__rive--loaded .art-slot__rive-fallback {
		opacity: 0;
	}

	.art-slot__rive--loaded .art-slot__rive-canvas {
		pointer-events: auto;
	}

	.rive-player__debug {
		position: absolute;
		right: 0.5rem;
		bottom: 0.5rem;
		margin: 0;
		padding: 0.4rem 0.5rem;
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.625rem;
		line-height: 1.35;
		color: rgba(255, 255, 255, 0.9);
		background: rgba(0, 0, 0, 0.65);
		pointer-events: none;
		z-index: 2;
	}

	.manual-scroller {
		position: fixed;
		right: 0.85rem;
		top: 50%;
		transform: translateY(-50%);
		width: min(13.5rem, 38vw);
		padding: 0.55rem 0.5rem 0.55rem 0.6rem;
		border: 1px solid rgba(26, 26, 26, 0.28);
		background: rgba(232, 229, 223, 0.8);
		backdrop-filter: blur(4px);
		z-index: 10990;
		display: grid;
		grid-template-columns: 8px 1fr;
		gap: 0.55rem;
	}

	.manual-scroller__track {
		position: relative;
		background: rgba(26, 26, 26, 0.1);
		border: 1px solid rgba(26, 26, 26, 0.16);
		min-height: 8.6rem;
	}

	.manual-scroller__fill {
		position: absolute;
		left: 0;
		right: 0;
		bottom: 0;
		height: calc(var(--manual-progress, 0) * 100%);
		background: linear-gradient(180deg, var(--raw), #661111);
	}

	.manual-scroller__sections {
		list-style: none;
		margin: 0;
		padding: 0;
		display: grid;
		gap: 0.22rem;
		max-height: 44vh;
		overflow: auto;
	}

	.manual-scroller__item {
		display: grid;
		grid-template-columns: 2ch 1fr;
		gap: 0.4rem;
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.54rem;
		line-height: 1.3;
		letter-spacing: 0.08em;
		text-transform: uppercase;
		color: rgba(26, 26, 26, 0.52);
		padding: 0.2rem 0.25rem;
		border-left: 2px solid transparent;
		text-decoration: none;
	}

	.manual-scroller__item strong {
		font-weight: 600;
		letter-spacing: 0.07em;
	}

	.manual-scroller__item.is-active {
		color: rgba(26, 26, 26, 0.96);
		border-left-color: var(--raw);
		background: rgba(255, 255, 255, 0.38);
	}

	.manual-scroller--reduced .manual-scroller__item {
		transition: none;
	}

	@media (max-width: 900px) {
		.manual-scroller {
			left: 0.65rem;
			right: 0.65rem;
			top: auto;
			bottom: 0.7rem;
			transform: none;
			width: auto;
			max-width: none;
			grid-template-columns: 1fr;
			gap: 0.38rem;
			padding: 0.45rem;
		}

		.manual-scroller__track {
			height: 7px;
			min-height: 0;
		}

		.manual-scroller__fill {
			height: 100%;
			width: calc(var(--manual-progress, 0) * 100%);
		}

		.manual-scroller__sections {
			display: flex;
			gap: 0.28rem;
			overflow: auto;
			max-height: none;
		}

		.manual-scroller__sections > li {
			flex: 0 0 auto;
		}

		.manual-scroller__item {
			display: inline-flex;
			align-items: center;
			gap: 0.36rem;
			white-space: nowrap;
			padding: 0.18rem 0.3rem;
			border-left: 0;
			border-bottom: 2px solid transparent;
		}

		.manual-scroller__item.is-active {
			border-bottom-color: var(--raw);
		}
	}

	.motion-os-hud {
		position: fixed;
		left: 0.75rem;
		bottom: 0.75rem;
		width: min(26rem, calc(100vw - 1.5rem));
		background: rgba(10, 10, 10, 0.9);
		color: #f5f5f5;
		border: 1px solid rgba(255, 255, 255, 0.35);
		z-index: 12000;
		backdrop-filter: blur(6px);
	}

	.motion-os-hud__head {
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.625rem;
		font-weight: 700;
		letter-spacing: 0.12em;
		text-transform: uppercase;
		padding: 0.4rem 0.55rem;
		border-bottom: 1px solid rgba(255, 255, 255, 0.25);
	}

	.motion-os-hud__body {
		margin: 0;
		padding: 0.55rem;
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.625rem;
		line-height: 1.45;
		white-space: pre-wrap;
	}

	.motion-os-hud-toggle {
		position: fixed;
		left: 0.75rem;
		bottom: 0.75rem;
		z-index: 11999;
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.625rem;
		letter-spacing: 0.1em;
		text-transform: uppercase;
		padding: 0.3rem 0.5rem;
		border: 1px solid var(--charcoal);
		background: rgba(232, 229, 223, 0.92);
		color: var(--charcoal);
	}

	.motion-os-intensity-toggle {
		position: fixed;
		left: 0.75rem;
		bottom: 2.7rem;
		z-index: 11999;
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.625rem;
		letter-spacing: 0.1em;
		text-transform: uppercase;
		padding: 0.3rem 0.5rem;
		border: 1px solid var(--charcoal);
		background: rgba(232, 229, 223, 0.92);
		color: var(--charcoal);
	}

	.motion-os-hud:not([hidden]) + .motion-os-hud-toggle {
		bottom: calc(0.75rem + 10.75rem);
	}

	.lab-rive-fallback {
		width: 100%;
		height: 100%;
		display: flex;
		align-items: center;
		justify-content: center;
		background: linear-gradient(135deg, rgba(0, 0, 0, 0.035), rgba(0, 0, 0, 0.01));
	}

	.lab-rive-fallback span {
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.625rem;
		text-transform: uppercase;
		letter-spacing: 0.12em;
		color: rgba(0, 0, 0, 0.45);
	}

	#route-kinetic-punctuation {
		position: fixed;
		inset: 0;
		pointer-events: none;
		z-index: 11000;
		opacity: 0;
		background: linear-gradient(90deg, transparent 0%, rgba(155, 27, 27, 0.22) 40%, rgba(155, 27, 27, 0.6) 50%, rgba(155, 27, 27, 0.22) 60%, transparent 100%);
		transform: translateX(-30%) skewX(-8deg);
	}

	.motion-route-pulse #route-kinetic-punctuation {
		animation: route-punctuation-sweep calc(520ms + (360ms * var(--motion-strength))) cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
	}

	.motion-route-pulse #route-kinetic-punctuation::before,
	.motion-route-pulse #route-kinetic-punctuation::after {
		content: '';
		position: absolute;
		inset: 0;
	}

	.motion-route-pulse #route-kinetic-punctuation::before {
		background: radial-gradient(circle at center, rgba(155, 27, 27, 0.3), transparent 58%);
		animation: route-punctuation-bloom calc(420ms + (260ms * var(--motion-strength))) ease-out;
	}

	.motion-route-pulse #route-kinetic-punctuation::after {
		background: repeating-linear-gradient(-12deg, transparent 0 20px, rgba(255, 255, 255, 0.18) 20px 22px);
		animation: route-punctuation-scan calc(320ms + (220ms * var(--motion-strength))) ease-out;
	}

	.route-punctuation-rive {
		position: fixed;
		right: 1.2rem;
		bottom: 1.2rem;
		width: calc(82px + (48px * var(--motion-strength)));
		height: calc(82px + (48px * var(--motion-strength)));
		pointer-events: none;
		z-index: 11001;
		opacity: 0;
		mix-blend-mode: multiply;
		transition: transform 220ms ease, opacity 220ms ease;
	}

	.motion-route-pulse .route-punctuation-rive {
		transform: scale(calc(1 + (0.22 * var(--motion-strength)))) rotate(-3deg);
		opacity: 0.85;
	}

	.route-punctuation-rive .rive-player__canvas {
		opacity: 1;
	}

	.route-punctuation-fallback {
		position: absolute;
		inset: 0;
		border: 2px solid rgba(26, 26, 26, 0.18);
		background: linear-gradient(145deg, rgba(155, 27, 27, 0.12), rgba(155, 27, 27, 0.03));
		opacity: 0;
	}

	.motion-route-pulse .route-punctuation-fallback {
		opacity: 1;
	}

	@keyframes route-punctuation-sweep {
		0% {
			opacity: 0;
			transform: translateX(-35%) skewX(-8deg);
		}
		16% {
			opacity: 1;
		}
		100% {
			opacity: 0;
			transform: translateX(35%) skewX(-8deg);
		}
	}

	@keyframes route-punctuation-bloom {
		0% { opacity: 0; transform: scale(0.92); }
		30% { opacity: 1; }
		100% { opacity: 0; transform: scale(1.05); }
	}

	@keyframes route-punctuation-scan {
		0% { opacity: 0; transform: translateX(-8%); }
		20% { opacity: 0.9; }
		100% { opacity: 0; transform: translateX(8%); }
	}

	#motion-intro-curtain {
		position: fixed;
		inset: 0;
		pointer-events: none;
		z-index: 11500;
		opacity: 0;
	}

	#motion-intro-curtain > span {
		position: absolute;
		inset: 0;
		display: block;
		background: linear-gradient(105deg, rgba(26, 26, 26, 0.94), rgba(13, 13, 13, 0.92));
		transform: translateX(-102%);
	}

	#motion-intro-curtain > span:last-child {
		background: linear-gradient(105deg, rgba(155, 27, 27, 0.7), rgba(26, 26, 26, 0.84));
		transform: translateX(102%);
	}

	html.motion-intro-sequence #motion-intro-curtain {
		opacity: 1;
	}

	html.motion-intro-sequence #motion-intro-curtain > span:first-child {
		animation: intro-curtain-left calc(780ms + (720ms * var(--motion-strength))) cubic-bezier(0.2, 0.9, 0.2, 1) forwards;
	}

	html.motion-intro-sequence #motion-intro-curtain > span:last-child {
		animation: intro-curtain-right calc(920ms + (760ms * var(--motion-strength))) cubic-bezier(0.2, 0.9, 0.2, 1) forwards;
	}

	html[data-motion-intensity] [data-motion-chapter] {
		opacity: 0.08;
		transform: translateY(calc(30px * var(--motion-strength)));
		transition: transform calc(220ms + (380ms * var(--motion-strength))) cubic-bezier(0.2, 0.8, 0.2, 1), opacity calc(220ms + (380ms * var(--motion-strength))) ease;
	}

	html[data-motion-intensity] [data-motion-chapter].motion-chapter-in {
		opacity: 1;
		transform: translateY(0);
	}

	html[data-motion-intensity] .hero-section {
		transform: translateY(calc(var(--motion-hero-progress) * -22px * var(--motion-strength)));
		filter: saturate(calc(1 + (0.16 * var(--motion-hero-progress) * var(--motion-strength))));
		will-change: transform;
	}

	#home-motion-moment {
		position: relative;
		overflow: clip;
	}

	#home-motion-moment::after {
		content: '';
		position: absolute;
		left: 0;
		right: 0;
		top: 0;
		height: 4px;
		background: linear-gradient(90deg, transparent 0%, var(--raw) 50%, transparent 100%);
		transform-origin: center;
		transform: scaleX(calc(0.2 + (var(--motion-specimen-progress) * 0.8)));
		opacity: calc(0.25 + (var(--motion-specimen-progress) * 0.6));
		pointer-events: none;
	}

	.motion-lab-card {
		opacity: 0.2;
		transform: translateY(16px) scale(0.985);
		transition: transform 360ms cubic-bezier(0.2, 0.8, 0.2, 1), opacity 320ms ease, filter 280ms ease;
	}

	.motion-lab-card.is-awake {
		opacity: 1;
		transform: translateY(0) scale(1);
	}

	.motion-lab-card.is-dimmed {
		opacity: 0.45;
		filter: grayscale(38%) contrast(92%);
	}

	@keyframes intro-curtain-left {
		0% { transform: translateX(-102%); }
		22% { transform: translateX(0); }
		100% { transform: translateX(102%); }
	}

	@keyframes intro-curtain-right {
		0% { transform: translateX(102%); }
		28% { transform: translateX(0); }
		100% { transform: translateX(-102%); }
	}

	@media (prefers-reduced-motion: reduce) {
		.art-slot__rive-canvas {
			display: none;
		}

		.motion-route-pulse #route-kinetic-punctuation {
			animation: none;
			opacity: 0.28;
		}

		html[data-motion-intensity] [data-motion-chapter] {
			opacity: 1;
			transform: none;
		}

		.route-punctuation-rive .rive-player__canvas {
			display: none;
		}

		.motion-lab-card {
			opacity: 1;
			transform: none;
		}
	}

	/* -----------------------------------------------------------
	 * TOOL CARD: Upgraded with stamped shadows by default
	 * ----------------------------------------------------------- */

	.tool-card {
		background-color: var(--bg-manual-light);
		border: var(--border-weight) solid var(--border-color);
		box-shadow: var(--shadow-stamp);
		transition: all 0.2s cubic-bezier(0.2, 0, 0, 1);
	}

	.tool-card:hover {
		transform: translate(-2px, -2px);
		box-shadow: var(--shadow-stamp-hover);
		border-color: var(--ink);
	}

	.tool-card:focus-visible {
		outline: 2px solid var(--raw);
		outline-offset: 3px;
	}

	/* -----------------------------------------------------------
	 * PAINTING CARD: Gallery-grade frame + museum wall label
	 * The image is treated as a physical object — matted,
	 * bordered, with stamped depth. The label beneath it uses
	 * the monospaced instrument layer.
	 * ----------------------------------------------------------- */

	.painting-card {
		display: block;
		text-decoration: none;
		color: inherit;
	}

	.painting-card__frame {
		border: var(--border-weight) solid var(--border-color);
		box-shadow: var(--shadow-stamp);
		background: #fafaf8;
		transition: transform 0.2s cubic-bezier(0.2, 0, 0, 1),
					box-shadow 0.2s cubic-bezier(0.2, 0, 0, 1);
	}

	/* The mat: generous white space around the image */
	.painting-card__mat {
		padding: 1rem;
		background-color: #f0ede8;
	}

	.painting-card--featured .painting-card__mat {
		padding: 1.5rem;
	}

	.painting-card--featured .painting-card__frame {
		box-shadow: var(--shadow-stamp-lg);
	}

	.painting-card__image {
		width: 100%;
		height: auto;
		display: block;
		object-fit: cover;
	}

	/* Hover: lift the frame */
	.painting-card:hover .painting-card__frame {
		transform: translate(-2px, -2px);
		box-shadow: var(--shadow-stamp-hover);
	}

	/* Gallery label — the museum wall text */
	.painting-card__label {
		padding-top: 0.75rem;
		padding-left: 2px; /* Optical alignment with frame edge */
	}

	.painting-card__title {
		font-family: 'Inter', system-ui, sans-serif;
		font-weight: 700;
		font-size: 1rem;
		letter-spacing: -0.01em;
		line-height: 1.3;
		color: var(--ink);
		margin: 0 0 0.25rem 0;
		transition: color 0.15s ease;
	}

	.painting-card:hover .painting-card__title {
		color: var(--raw);
	}

	.painting-card__available {
		color: var(--raw);
		font-size: 0.5rem;
		vertical-align: super;
		margin-left: 0.25rem;
	}

	.painting-card__meta {
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.6875rem;
		font-weight: 400;
		letter-spacing: 0.02em;
		color: rgba(0, 0, 0, 0.5);
		margin: 0 0 0.125rem 0;
	}

	.painting-card__dimensions {
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.625rem;
		font-weight: 400;
		letter-spacing: 0.04em;
		color: rgba(0, 0, 0, 0.35);
		margin: 0;
	}

	.painting-card__series {
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.5625rem;
		font-weight: 700;
		text-transform: uppercase;
		letter-spacing: 0.1em;
		color: rgba(0, 0, 0, 0.25);
		margin: 0.5rem 0 0 0;
	}

	/* -----------------------------------------------------------
	 * GALLERY GRID: Asymmetric masonry-like layout
	 * Featured paintings span 2 columns. Regular paintings
	 * sit in a standard column. On mobile, everything stacks.
	 * ----------------------------------------------------------- */

	.gallery-grid {
		display: grid;
		grid-template-columns: 1fr;
		gap: 2.5rem;
	}

	@media (min-width: 768px) {
		.gallery-grid {
			grid-template-columns: repeat(12, 1fr);
			gap: 2rem;
			row-gap: 3rem;
		}

		/* Featured: spans 7 columns */
		.gallery-grid__item--featured {
			grid-column: span 7;
		}

		/* Regular: spans 5 columns */
		.gallery-grid__item--regular {
			grid-column: span 5;
		}

		/* Full-width break for dramatic pacing */
		.gallery-grid__item--full {
			grid-column: 1 / -1;
		}
	}

	@media (min-width: 1024px) {
		.gallery-grid {
			gap: 2.5rem;
			row-gap: 3.5rem;
		}
	}

	/* -----------------------------------------------------------
	 * WORDMARK: Gothic blackletter with glitch on hover
	 * The text is the brand. No images. CSS-only animation.
	 * ----------------------------------------------------------- */

	.wordmark {
		display: inline-block;
		position: relative;
		line-height: 1;
		cursor: pointer;
	}

	.wordmark__text {
		font-family: 'UnifrakturMaguntia', 'Times New Roman', serif;
		font-size: 1.75rem;
		font-weight: 400;
		color: var(--ink);
		letter-spacing: 0.01em;
		display: inline-block;
		position: relative;
		transition: color 0.1s ease;
	}

	@media (min-width: 768px) {
		.wordmark__text {
			font-size: 2.25rem;
		}
	}

	/* Glitch ghost layer — crimson, offset, clipped */
	.wordmark__text::before,
	.wordmark__text::after {
		content: attr(data-text);
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		opacity: 0;
		pointer-events: none;
		transition: opacity 0.15s ease;
	}

	.wordmark__text::before {
		color: var(--raw);
		clip-path: inset(0 0 65% 0);
		transform: translate(-2px, -1px);
	}

	.wordmark__text::after {
		color: var(--raw);
		clip-path: inset(60% 0 0 0);
		transform: translate(2px, 1px);
	}

	/* Hover: ghost layers appear, main text shifts subtly */
	.wordmark:hover .wordmark__text::before,
	.wordmark:hover .wordmark__text::after {
		opacity: 0.8;
	}

	.wordmark:hover .wordmark__text::before {
		animation: wordmark-glitch-top 0.3s ease-out both;
	}

	.wordmark:hover .wordmark__text::after {
		animation: wordmark-glitch-bottom 0.3s ease-out 0.05s both;
	}

	@keyframes wordmark-glitch-top {
		0%   { opacity: 0; transform: translate(0, 0); clip-path: inset(0 0 65% 0); }
		20%  { opacity: 1; transform: translate(-3px, -2px); clip-path: inset(10% 0 55% 0); }
		40%  { opacity: 0.6; transform: translate(2px, 0); clip-path: inset(0 0 70% 0); }
		60%  { opacity: 0.9; transform: translate(-1px, -1px); clip-path: inset(5% 0 60% 0); }
		100% { opacity: 0.7; transform: translate(-2px, -1px); clip-path: inset(0 0 65% 0); }
	}

	@keyframes wordmark-glitch-bottom {
		0%   { opacity: 0; transform: translate(0, 0); clip-path: inset(60% 0 0 0); }
		20%  { opacity: 1; transform: translate(3px, 1px); clip-path: inset(50% 0 0 0); }
		40%  { opacity: 0.6; transform: translate(-2px, 2px); clip-path: inset(65% 0 0 0); }
		60%  { opacity: 0.9; transform: translate(1px, 1px); clip-path: inset(55% 0 0 0); }
		100% { opacity: 0.7; transform: translate(2px, 1px); clip-path: inset(60% 0 0 0); }
	}

	/* Respect reduced motion — disable glitch, keep static */
	@media (prefers-reduced-motion: reduce) {
		.wordmark:hover .wordmark__text::before,
		.wordmark:hover .wordmark__text::after {
			animation: none;
			opacity: 0;
		}
	}

	/* -----------------------------------------------------------
	 * HERO SECTION: Opening page of the manual
	 * Subtle paper texture, structural presence.
	 * ----------------------------------------------------------- */

	.hero-section {
		background-color: transparent;
		position: relative;
	}

	/* Faint top rule inside the hero for "printed page" feel */
	.hero-section::before {
		content: '';
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		height: 3px;
		background: var(--raw);
		opacity: 0.7;
	}

	/* -----------------------------------------------------------
	 * REVEAL ANIMATIONS
	 * ----------------------------------------------------------- */

	.art-reveal--fade {
		animation: art-reveal-fade 420ms ease-out both;
	}

	.art-reveal--wipe .art-slot__frame::after {
		content: '';
		position: absolute;
		inset: 0;
		background: rgba(232, 229, 223, 0.96);
		animation: art-reveal-wipe 520ms ease-out both;
		pointer-events: none;
	}

	@keyframes art-reveal-fade {
		from { opacity: 0; transform: translateY(4px); }
		to   { opacity: 1; transform: translateY(0); }
	}

	@keyframes art-reveal-wipe {
		from { transform: translateX(0%); }
		to   { transform: translateX(102%); }
	}

	/* -----------------------------------------------------------
	 * PROSE OVERRIDES
	 * When Tailwind Typography is used, maintain the aesthetic.
	 * ----------------------------------------------------------- */

	.prose a {
		color: var(--raw);
		text-decoration: underline;
		text-underline-offset: 3px;
		text-decoration-thickness: 1px;
		transition: color 0.15s ease;
	}

	.prose a:hover {
		color: var(--raw-dark);
		text-decoration-thickness: 2px;
	}

	.prose code {
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-size: 0.875em;
		background: rgba(0, 0, 0, 0.04);
		padding: 0.15em 0.4em;
		border: 1px solid var(--bone);
	}

	.prose blockquote {
		border-left: 3px solid var(--raw);
		padding-left: 1.25rem;
		font-style: normal;
		color: var(--charcoal);
	}
}

/* =============================================================
 * UTILITY LAYER
 * ============================================================= */

@layer utilities {
	.reveal {
		@apply opacity-0 translate-y-4 transition duration-700 ease-out;
		will-change: transform, opacity;
	}

	.reveal--visible {
		@apply opacity-100 translate-y-0;
	}

	.reveal--instant {
		transition-duration: 0ms;
	}

	/* Material surface utility — inherits the noise from body */
	.bg-paper {
		background-color: var(--bg-manual-light);
	}

	/* Monospaced instrument text utility */
	.font-instrument {
		font-family: 'IBM Plex Mono', ui-monospace, monospace;
		font-variant-numeric: tabular-nums;
	}

	/* Raw accent text */
	.text-raw {
		color: var(--raw);
	}

	/* Structural divider — heavier than border-b */
	.divider-heavy {
		border-bottom: var(--border-weight) solid var(--border-color);
	}

	/* Divider with muted color */
	.divider-muted {
		border-bottom: 1px solid var(--bone);
	}
}

/* =============================================================
 * REDUCED MOTION: Respect user preferences
 * ============================================================= */

@media (prefers-reduced-motion: reduce) {
	*, *::before, *::after {
		animation-duration: 0.01ms !important;
		animation-iteration-count: 1 !important;
		transition-duration: 0.01ms !important;
		scroll-behavior: auto !important;
	}
}
